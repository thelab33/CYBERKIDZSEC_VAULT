{% set hero = {
  'typer_phrases': [
    '🔐 Zero-Day Archive Updating…',
    '💀 CYBERKIDZSEC VAULT',
    '“Ghosted but not gone.”'
  ],
  'heading': 'CYBERKIDZSEC VAULT',
  'subheading': '“Ghosted but not gone.”',
  'stats': [
    {'icon': '🚀', 'label': 'Operative Title', 'value': operative_title},
    {'icon': '⬆️', 'label': 'Level', 'value': operative_level},
    {'icon': '🛡️', 'label': 'Vault Stability', 'value': vault_xp_percentage ~ '%'}
  ],
  'ctas': [
    {'type': 'button', 'id': 'searchBtn', 'label': '⌘ Cmd + K — Search', 'classes': 'btn--outline'},
    {'type': 'link', 'href': '#playground', 'label': '🎮 Hack the Vault', 'classes': 'btn--solid'}
  ]
} %}

<section id="hero"
         role="banner"
         aria-labelledby="hero-heading hero-subheading"
         class="relative isolate flex flex-col items-center text-center rounded-3xl border border-orangeLuxe/30 bg-black/95 backdrop-blur-lg px-6 py-28 sm:py-36 lg:py-48 shadow-2xl shadow-orange-900/10 group perspective-600 space-y-8"
         data-aos="zoom-in"
         data-aos-delay="200">

  <canvas id="heroStarfield" class="absolute inset-0 w-full h-full z-0 pointer-events-none"></canvas>

  <div id="heroParallax" class="absolute inset-0 z-10 will-change-transform">
    <div class="orbit small animate-spin-slow"></div>
    <div class="orbit med animate-spin-slower"></div>
    <div class="orbit large animate-spin-slowest"></div>
  </div>

  <div aria-hidden="true" class="absolute inset-0 z-20 pointer-events-none">
    <div class="absolute inset-0 mix-blend-overlay animate-warpBlur"></div>
    <div class="absolute inset-0 bg-[url('/static/images/scanlines.svg')] bg-repeat opacity-5 animate-shimmer"></div>
    <div id="heroHalo" class="absolute inset-0 blur-2xl opacity-0 transition-opacity duration-1000 ease-out"></div>
    <div id="quantumGrid" class="absolute inset-0 bg-[url('/static/images/grid.svg')] opacity-5 mix-blend-color-dodge animate-pulse"></div>
  </div>

  <div class="relative z-30 max-w-4xl mx-auto space-y-8 text-orangeLuxe-light drop-shadow-[0_0_2px_orange]">

    <p id="heroTyper" class="text-sm sm:text-base font-mono uppercase tracking-widest text-emeraldLuxe" aria-live="polite"></p>

    <h1 id="hero-heading" class="text-6xl sm:text-7xl md:text-8xl font-black bg-clip-text text-transparent bg-gradient-to-r from-orange-400 via-yellow-500 to-orange-300 animate-pulse-glow glitch drop-shadow">
      <span class="hero-skull inline-block align-middle text-[1.2em] px-1">💀</span>
      {{ hero.heading }}
    </h1>

    <p id="hero-subheading" class="text-lg sm:text-xl font-mono text-white/80">{{ hero.subheading }}</p>

    <div id="heroStats" class="flex flex-col sm:flex-row sm:justify-center sm:space-x-8 space-y-6 sm:space-y-0 text-zinc-100">
      {% for stat in hero.stats %}
      <div class="flex items-center space-x-3 stat-countup" data-value="{{ stat.value | replace('%', '') }}">
        <span class="text-emeraldLuxe animate-pulse-glow text-3xl">{{ stat.icon }}</span>
        <div class="text-left">
          <div class="font-mono uppercase text-xs">{{ stat.label }}</div>
          <div class="font-bold text-xl"><span class="countup-target">{{ stat.value }}</span></div>
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="mt-6 flex flex-wrap justify-center gap-6">
      {% for cta in hero.ctas %}
        {% if cta.type == 'button' %}
          <button id="{{ cta.id }}" class="btn {{ cta.classes }} px-8 py-3 rounded-lg backdrop-blur-sm transition hover:shadow-lg">{{ cta.label }}</button>
        {% elif cta.type == 'link' %}
          <a href="{{ cta.href }}" class="btn {{ cta.classes }} px-8 py-3 rounded-lg backdrop-blur-sm transition hover:shadow-lg">{{ cta.label }}</a>
        {% endif %}
      {% endfor %}
    </div>

  </div>
</section>

<script type="module">
  document.addEventListener("DOMContentLoaded", () => {
    // Typing effect for hero phrases
    const typer = document.getElementById("heroTyper");
    const phrases = {{ hero.typer_phrases | tojson | safe }};
    let phraseIndex = 0;
    let charIndex = 0;

    function typePhrase() {
      if (!typer) return;
      if (charIndex < phrases[phraseIndex].length) {
        typer.textContent += phrases[phraseIndex][charIndex++];
        setTimeout(typePhrase, 50);
      } else {
        setTimeout(() => {
          typer.textContent = "";
          charIndex = 0;
          phraseIndex = (phraseIndex + 1) % phrases.length;
          typePhrase();
        }, 1600);
      }
    }
    typePhrase();

    // Count-up animation for stats
    const counters = document.querySelectorAll(".stat-countup");
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const targetEl = entry.target.querySelector(".countup-target");
          const maxValue = parseFloat(entry.target.dataset.value);
          let currentValue = 0;
          const interval = setInterval(() => {
            currentValue++;
            targetEl.textContent = currentValue >= maxValue ? `${maxValue}%` : `${currentValue}%`;
            if (currentValue >= maxValue) clearInterval(interval);
          }, 30);
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.6 });
    counters.forEach(el => observer.observe(el));
  });
</script>

